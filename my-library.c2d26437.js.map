{"mappings":"gfAAA,IAAAA,EAAAC,EAAA,S,yEAUA,EAAAC,EAAAC,4BACA,MAAMC,EAAaC,OAAOC,SAASC,KAEnC,IAAIC,EAAO,KAEX,MAAMC,EAAO,CACXC,WAAYC,SAASC,cAAc,iBACnCC,SAAUF,SAASC,cAAc,eACjCE,cAAeH,SAASC,cAAc,YACtCG,OAAQJ,SAASC,cAAc,eAC/BI,SAAUL,SAASC,cAAc,iBAgCnCK,eAAeC,IACbC,EAAUV,EAAKC,YACfU,EAAYX,EAAKI,UACjB,MAAMQ,QAAgB,EAAAC,EAAAC,oBAAmBf,EAAKgB,KAC9CC,EAAoBC,OAAOC,OAAON,GAASO,KAAIC,GAASA,EAAM,OAChE,CASA,SAAST,EAAYU,GACnBA,EAAGC,UAAUC,OAAO,uBACtB,CAEA,SAASb,EAAUW,GACjBA,EAAGC,UAAUE,IAAI,uBACnB,CAEA,SAASR,EAAoBS,GAC3BzB,EAAKK,cAAcqB,WAAY,EAAAC,EAAAC,SAAaH,EAC9C,EAzCAjB,iBACET,QAAa,EAAAR,EAAAsC,eACTlC,EAAWmC,SAAS,gBACjB/B,IACHH,OAAOC,SAASC,KAAO,iBASRiC,EANLhC,EAOdC,EAAKO,SAASyB,YAAcD,EAAKE,MAL/BxB,KAIJ,IAAqBsB,CAFrB,CAvBAG,GAEAlC,EAAKC,WAAWkC,iBAAiB,QAAS1B,GAC1CT,EAAKI,SAAS+B,iBAAiB,SAiC/B3B,iBACEE,EAAUV,EAAKI,UACfO,EAAYX,EAAKC,YACjB,MAAMmC,QAAe,EAAAvB,EAAAwB,kBAAiBtC,EAAKgB,KAC3CC,EAAoBC,OAAOC,OAAOkB,GAAQjB,KAAImB,GAASA,EAAM,OAC/D,IArCAtC,EAAKM,OAAO6B,iBAAiB,QAAS5C,EAAAgD,Y","sources":["src/js/my-library.js"],"sourcesContent":["import { currentUser, signOutUser } from './api-service/firebase-api-auth';\nimport { getWatchedByUserId, getQueueByUserId } from './api-service/firebase-api-database';\nimport filmsCardTpl from '../templates/card-films.hbs';\nimport { setThemeFromLocalStorage } from './theme-change';\n\n//open/close modal window NO DELETE!!\nimport openModal from './modal-info/modalInfoFilm';\nimport closeModal from './closeModal';\nimport onFooterModal from './modal-info/footer-modal';\n\nsetThemeFromLocalStorage();\nconst currentUrl = window.location.href;\n\nlet user = null;\n\nconst refs = {\n  btnWatched: document.querySelector('#btn__watched'),\n  btnQueue: document.querySelector('#btn__queue'),\n  containerList: document.querySelector('.js-card'),\n  logOut: document.querySelector('.js-log-out'),\n  nickname: document.querySelector('.js-nickname'),\n};\n\nstatus();\n\nrefs.btnWatched.addEventListener('click', onWatched);\nrefs.btnQueue.addEventListener('click', onQueue);\nrefs.logOut.addEventListener('click', signOutUser);\n\n// if (currentUrl.includes('my-library')) {\n//   if (!getUid()) {\n//     //window.location.href = '../auth/signin.html';\n//   }\n// }\n\nasync function status() {\n  user = await currentUser();\n  if (currentUrl.includes('my-library')) {\n    if (!user) {\n      window.location.href = './signin.html';\n    }\n\n    setNickname(user);\n\n    onWatched();\n  }\n}\n\nfunction setNickname(user) {\n  refs.nickname.textContent = user.email;\n}\n\nasync function onWatched() {\n  activeBtn(refs.btnWatched);\n  inactiveBtn(refs.btnQueue);\n  const watches = await getWatchedByUserId(user.uid);\n  appendResultsMarkup(Object.values(watches).map(watch => watch['film']));\n}\n\nasync function onQueue() {\n  activeBtn(refs.btnQueue);\n  inactiveBtn(refs.btnWatched);\n  const queues = await getQueueByUserId(user.uid);\n  appendResultsMarkup(Object.values(queues).map(queue => queue['film']));\n}\n\nfunction inactiveBtn(bt) {\n  bt.classList.remove('btn__library--active');\n}\n\nfunction activeBtn(bt) {\n  bt.classList.add('btn__library--active');\n}\n\nfunction appendResultsMarkup(results) {\n  refs.containerList.innerHTML = filmsCardTpl(results);\n}\n"],"names":["$bZgM4","parcelRequire","$82vFN","setThemeFromLocalStorage","$bb2af86579234925$var$currentUrl","window","location","href","$bb2af86579234925$var$user","$bb2af86579234925$var$refs","btnWatched","document","querySelector","btnQueue","containerList","logOut","nickname","async","$bb2af86579234925$var$onWatched","$bb2af86579234925$var$activeBtn","$bb2af86579234925$var$inactiveBtn","watches","$cqQ1z","getWatchedByUserId","uid","$bb2af86579234925$var$appendResultsMarkup","Object","values","map","watch","bt","classList","remove","add","results","innerHTML","$2qgW3","default","currentUser","includes","user","textContent","email","$bb2af86579234925$var$status","addEventListener","queues","getQueueByUserId","queue","signOutUser"],"version":3,"file":"my-library.c2d26437.js.map"}